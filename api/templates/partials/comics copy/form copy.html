{% load static i18n widget_tweaks example %}

<div id="form-container" class="px-2 pt-3">
  <div class="rounded-lg border border-gray-200  p-2 shadow-sm dark:border-gray-700  sm:p-3 mb-3">
    <form action='.'
          method="POST"
          class='space-y-2 mb-2  mx-auto'
          hx-swap="outerHTML"
          hx-target='#form-container'
          hx-indicator='#spinner'
          hx-post='.'
          {% if form.instance.id %} hx-trigger='submit, change delay:500ms' {% else %} hx-trigger='submit' {% endif %}>
      <h3 class="mb-2 text-xl font-bold text-gray-900 dark:text-white">Comic</h3>
      <span class="text-base font-normal text-gray-500 dark:text-gray-400">This is a form for comic</span>
      {% csrf_token %}
      <div class="grid gap-4 mb-1 sm:grid-cols-2 sm:gap-1 sm:mb-1">
        <div class="w-full">
          <label for="{{ form.title.name }}" class="custom_label">{{ form.title.label }}</label>
          {{ form.title|add_classes:'custom_char_input' }}
          <div class="mt-1 text-gray-500">{{ form.title.help_text|safe }}</div>
          <div class="ml-3 text-xs text-red-400">{{ form.title.errors }}</div>
        </div>
        <div class="w-full">
          <label for="{{ form.status.name }}" class="custom_label">{{ form.status.label }}</label>
          {{ form.status|add_classes:'custom_select_input' }}
          <div class="mt-1 text-gray-500">{{ form.status.help_text|safe }}</div>
          <div class="ml-3 text-xs text-red-400">{{ form.status.errors }}</div>
        </div>
        <div class="w-full">
          <label for="{{ form.type.name }}" class="custom_label">{{ form.type.label }}</label>
          {{ form.type|add_classes:'custom_select_input' }}
          <div class="mt-1 text-gray-500">{{ form.type.help_text|safe }}</div>
          <div class="ml-3 text-xs text-red-400">{{ form.type.errors }}</div>
        </div>
        <div class="w-full">
          <label for="{{ form.artist.name }}" class="custom_label">{{ form.artist.label }}</label>
          {{ form.artist|add_classes:'custom_select_input' }}
          <div class="mt-1 text-gray-500">{{ form.artist.help_text|safe }}</div>
          <div class="ml-3 text-xs text-red-400">{{ form.artist.errors }}</div>
        </div>
        <div class="w-full">
          <label for="{{ form.author.name }}" class="custom_label">{{ form.author.label }}</label>
          {{ form.author|add_classes:'custom_select_input' }}
          <div class="mt-1 text-gray-500">{{ form.author.help_text|safe }}</div>
          <div class="ml-3 text-xs text-red-400">{{ form.author.errors }}</div>
        </div>
        <div class="w-full">
          <label for="{{ form.rating.name }}" class="custom_label">{{ form.rating.label }}</label>
          {{ form.rating|add_classes:'custom_char_input' }}
          <div class="mt-1 text-gray-500">{{ form.rating.help_text|safe }}</div>
          <div class="ml-3 text-xs text-red-400">{{ form.rating.errors }}</div>
        </div>
        <div class="w-full">
          <label for="{{ form.description.name }}" class="custom_label">{{ form.description.label }}</label>
          {{ form.description|add_classes:'custom_textarea_input' }}
          <div class="mt-1 text-gray-500">{{ form.description.help_text|safe }}</div>
          <div class="ml-3 text-xs text-red-400">{{ form.description.errors }}</div>
        </div>
        <div class="w-full">
          <label for="{{ form.updated_at.name }}" class="custom_label">{{ form.updated_at.label }}</label>
          {{ form.updated_at|add_classes:'custom_char_input' }}
          <div class="mt-1 text-gray-500">{{ form.updated_at.help_text|safe }}</div>
          <div class="ml-3 text-xs text-red-400">{{ form.updated_at.errors }}</div>
        </div>
        <div class="w-full">
          <label for="{{ form.url.name }}" class="custom_label">{{ form.url.label }}</label>
          {{ form.url|add_classes:'custom_char_input' }}
          <div class="mt-1 text-gray-500">{{ form.url.help_text|safe }}</div>
          <div class="ml-3 text-xs text-red-400">{{ form.url.errors }}</div>
        </div>
        <div class="w-full">
          <label for="{{ form.spider.name }}" class="custom_label">{{ form.spider.label }}</label>
          {{ form.spider|add_classes:'custom_char_input' }}
          <div class="mt-1 text-gray-500">{{ form.spider.help_text|safe }}</div>
          <div class="ml-3 text-xs text-red-400">{{ form.spider.errors }}</div>
        </div>
        <div class="w-full">
          <label for="{{ form.serialization.name }}" class="custom_label">{{ form.serialization.label }}</label>
          {{ form.serialization|add_classes:'custom_char_input' }}
          <div class="mt-1 text-gray-500">{{ form.serialization.help_text|safe }}</div>
          <div class="ml-3 text-xs text-red-400">{{ form.serialization.errors }}</div>
        </div>
        <div class="w-full">
          <label for="{{ form.genres.name }}" class="custom_label">{{ form.genres.label }}</label>
          {{ form.genres|add_classes:'custom_mulselect_input' }}
          <div class="mt-1 text-gray-500">{{ form.genres.help_text|safe }}</div>
          <div class="ml-3 text-xs text-red-400">{{ form.genres.errors }}</div>
        </div>
      </div>
      <div class="mt-4 flex justify-between gap-2 items-center">
        <button type="submit"
                class="inline-flex items-center px-3 py-2 text-sm font-medium text-center text-white rounded-lg bg-primary-700 hover:bg-primary-800 focus:ring-4 focus:ring-primary-300 dark:bg-primary-600 dark:hover:bg-primary-700 dark:focus:ring-primary-800">
          {% trans "Submit" %}
        </button>
        <button href='{% url "comics:comic_list" %}'
                hx-get='{% url "comics:comic_list" %}'
                hx-swap="outerHTML"
                hx-target='#form-container'
                hx-indicator='#spinner'
                hx-push-url='true'
                class="inline-flex items-center px-3 py-2 text-sm font-medium text-center text-white bg-red-600 rounded-lg hover:bg-red-800 focus:ring-4 focus:ring-red-300 dark:focus:ring-red-900">
          {% trans "Cancel" %}
        </button>
      </div>
    </form>
    {% if form.instance.id %}
      {% with images=object.get_comic_images_children %}
        <div class='mt-4'>
          <h3 class="mb-2 text-xl font-bold text-gray-900 dark:text-white">Comic Image</h3>
          <div class="flow-root mb-2">
            <ul role="list" class="divide-y divide-gray-200 dark:divide-gray-700">
              {% for img in images %}
                {% include "partials/comics/images-inline.html" with object=img %}
              {% empty %}
                <span class="mr-2 rounded-md border border-red-100 bg-red-100 px-2.5 py-0.5 text-xs font-medium text-red-800 dark:border-red-500 dark:bg-gray-700 dark:text-red-400">No Comic Images...</span>
              {% endfor %}
            </ul>
          </div>
          {% if new_comic_image_url %}
            <div id='comic-create'></div>
            <button class='w-1/2 px-3 py-2 text-sm font-medium text-center text-white rounded-lg bg-primary-700 hover:bg-primary-800 focus:ring-4 focus:ring-primary-300 sm:w-auto dark:bg-primary-600 dark:hover:bg-primary-700 dark:focus:ring-primary-800'
                    href="{{ new_comic_image_url }}"
                    hx-get="{{ new_comic_image_url }}"
                    hx-target='#comic-create'
                    hx-indicator='#spinner'
                    hx-swap='beforeend'>{% translate "Add New Comic Image Form" %}</button>
          {% endif %}
        </div>
      {% endwith %}
    {% endif %}
    {% include "partials/htmx/spinner.html" %}
  </div>
</div>
